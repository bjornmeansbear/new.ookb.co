'use strict';if(!window.PBS){window.PBS={};}
if($.browser.msie&&parseInt($.browser.version)<9){$('html').addClass('lt-ie9');}
PBS.Helper=(function(){var W=512,H=376,RATIO=1.77777777777778, videoAdsThreshold=180;function detectIos(){return((navigator.userAgent.indexOf('iPhone')!==-1)||(navigator.userAgent.indexOf('iPod')!==-1)||(navigator.userAgent.indexOf('iPad')!==-1));}
function detectIE(version){var ua=window.navigator.userAgent,match=ua.match(/(?:(MSIE) |(Trident)\/.+rv:)([\w.]+)/i);return match&&~match[3].indexOf(version);} 
function generateRandomNr(length){var randomNr=Math.floor(Math.pow(10,length-1)+Math.random()*9*Math.pow(10,length-1));return randomNr;} 
var guid=(function(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return function(){return s4()+s4()+'-'+s4()+'-'+s4()+'-'+
s4()+'-'+s4()+s4()+s4();};})();  function detectFlash(){var hasFlash=false;try{var flash=new ActiveXObject('ShockwaveFlash.ShockwaveFlash');if(flash){hasFlash=true;}}catch(e){if(navigator.mimeTypes['application/x-shockwave-flash']!==undefined){hasFlash=true;}}
return hasFlash;} 
function getLocalId(){var localId=PBS.Storage.getStorageItem(localStorage,'guid');if(!localId){PBS.Storage.setStorageItem(localStorage,'guid',GUID);localId=GUID;}
return localId;}
function getSessionId(){var sessionId=PBS.Storage.getStorageItem(sessionStorage,'guid');if(!sessionId){PBS.Storage.setStorageItem(sessionStorage,'guid',GUID);sessionId=GUID;}
return sessionId;} 
Object.keys=Object.keys||(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!{toString:null}.propertyIsEnumerable('toString'),DontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],DontEnumsLength=DontEnums.length;return function(o){if((typeof o!=='object'&&typeof o!=='function')||o===null){throw new TypeError('Object.keys called on a non-object');}
var result=[],name,i;for(name in o){if(hasOwnProperty.call(o,name)){result.push(name);}}
if(hasDontEnumBug){for(i=0;i<DontEnumsLength;i+=1){if(hasOwnProperty.call(o,DontEnums[i])){result.push(DontEnums[i]);}}}
return result;};}()); String.prototype.capitalize=function(){return this.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase();});};function getUrlVar(variable){var query=window.location.search.substring(1),vars=query.split('&'),pair,i;for(i=0;i<vars.length;i++){pair=vars[i].split('=');if(pair[0]===variable){return pair[1];}}
return false;}
function parseExtendedCookie(cookieName,key){var cookieData=$.cookie(cookieName);var cookieArray=decodeURIComponent(cookieData).split('#');var regex=new RegExp('^'+key+'=','g'),stations;$.each(cookieArray,function(i,v){if(regex.test(v)){var temp=v.split('=');stations=temp[1];stations=stations.replace('[','');stations=stations.replace(']','');stations=stations.replace(/"/g,'');stations=stations.split(',');}});return stations;}
function updateEmbedCode(w,h,siteUrl,videoId,selectedChapter){W=w>=320?w:320;H=h>=258?h:258;var chapter=''; if(siteUrl.slice(-1)!='/'){siteUrl=siteUrl+'/';}
if(selectedChapter){chapter='?chapter='+selectedChapter;}
return'<iframe width="'+W+'" height="'+H+'" src="'+siteUrl+'viralplayer/'+videoId+chapter+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" seamless></iframe>';}
function getHeight(w){var h=Math.ceil(w/RATIO,10);h+=w<=480?78:88;return h;}
function getWidth(h){var temp=h<=348?h-78:h-88,w=parseInt(RATIO*temp,10);return w;}
function getVideoAdsThreshold(){return videoAdsThreshold;}
function updateEmbedDimensions(id,siteUrl,videoId){var $embedVideo=$(id),$embedText=$embedVideo.find('.embed-text'),$embedWidth=$embedVideo.find('.embed-width'),$embedHeight=$embedVideo.find('.embed-height'),selectedChapter;$embedText.val(updateEmbedCode(W,H,siteUrl,videoId));if($embedVideo.find('.chapter-carousel').length>0){var $chapterCarousel=$embedVideo.find('.chapter-carousel'),$chapters=$chapterCarousel.find('.item a');selectedChapter=$chapterCarousel.find('a.selected').data('chapter');if(selectedChapter){$embedText.val(updateEmbedCode($embedWidth.val(),$embedHeight.val(),siteUrl,videoId,selectedChapter));}
$chapters.on('click',function(e){e.preventDefault();var $el=$(this);$chapters.removeClass('selected');$el.addClass('selected');selectedChapter=$el.data('chapter');$embedText.val(updateEmbedCode($embedWidth.val(),$embedHeight.val(),siteUrl,videoId,selectedChapter));});}
$embedHeight.keyup(function(){var h=$(this).val(),w=getWidth(h);$embedWidth.val(w);$embedText.val(updateEmbedCode(w,h,siteUrl,videoId,selectedChapter));});$embedWidth.keyup(function(){var w=$(this).val(),h=getHeight(w);$embedHeight.val(h);$embedText.val(updateEmbedCode(w,h,siteUrl,videoId,selectedChapter));});}
return{getRandomNr:generateRandomNr,guid:guid,detectFlash:detectFlash,detectIos:detectIos,detectIE:detectIE,getUrlVar:getUrlVar,parseExtendedCookie:parseExtendedCookie,getLocalId:getLocalId,getSessionId:getSessionId,getVideoAdsThreshold:getVideoAdsThreshold,updateEmbedDimensions:updateEmbedDimensions};}());

if(document.addEventListener){document.addEventListener("confirmStationEvent",function(event){if(event.data.donate=="Donate"){var membership_url=event.data.link;var confirmBtn=event.data.confirmBtn;document.querySelector(confirmBtn).click(window.open(membership_url,"_blank"));return false;}});}else{document.attachEvent("confirmStationEvent",function(event){if(event.data.donate=="Donate"){var membership_url=event.data.link;var confirmBtn=event.data.confirmBtn;document.querySelector(confirmBtn).click(window.open(membership_url,"_blank"));return false;}});}
(function(window,$){if(!window.PBS){window.PBS={}}
PBS.Storage=(function(){function setStorageItem(storage,variable,value){try{storage.setItem(variable,value);}catch(error){console.log(error);}}
function getStorageItem(storage,variable){try{return storage.getItem(variable);}catch(error){console.log(error);}
return 0;}
function removeStorageItem(storage,variable){try{storage.removeItem(variable);}catch(error){console.log(error);}}
return{setStorageItem:setStorageItem,getStorageItem:getStorageItem,removeStorageItem:removeStorageItem}}());})(window,jQuery);(function(window,$){if(!window.PBS){window.PBS={};}
PBS.Local=(function(){function setStation(callSign,commonName,zipCode,reload){ $.cookie("pbsol.station",callSign,{expires:360,path:'/',domain:".pbs.org"}); $.cookie("pbsol.common.name",commonName,{expires:360,path:'/',domain:".pbs.org"});PBS.Profile.favoriteStations.add(callSign,zipCode);if(reload){location.reload();}};function getStation(){return $.cookie('pbsol.station');};function clearStation(){}
function validateZipCode(zipcode){return /(^\d{5}$)|(^\d{5}-\d{4}$)/.test(zipcode);}
return{setStation:setStation,getStation:getStation,clearStation:clearStation,validateZipCode:validateZipCode};})();})(window,jQuery);(function($,document){var pluses=/\+/g;function raw(s){return s;}
function decoded(s){return decodeURIComponent(s.replace(pluses,' '));}
$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value==null)){options=$.extend({},$.cookie.defaults,options);if(value===null){options.expires=-1;}
if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}
value=String(value);return(document.cookie=[encodeURIComponent(key),'=',options.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'', options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
options=value||$.cookie.defaults||{};var decode=options.raw?raw:decoded;var cookies=document.cookie.split('; ');for(var i=0,parts;(parts=cookies[i]&&cookies[i].split('='));i++){if(decode(parts.shift())===key){return decode(parts.join('='));}}
return null;};$.cookie.defaults={};}(jQuery,document));(function(window,$){"use strict";if(!window.PBS){window.PBS={};}
PBS.Profile=(function(){function htmlEntities(str){return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
function showCopyMessage(message){$('.copy-message').addClass('hidden');$('.copy-message.'+message).removeClass('hidden');}
function triggerLogin(message,data){if(!$("#loginModalWindow").hasClass('initiated')){ $("#loginModalWindow").modalLogin();}
showCopyMessage(message); $.fn.modalLogin.show();if(data){ PBS.Profile.uua.setData(JSON.stringify(data)); $.fn.modalLogin.showUpgragedMessage();}}
function signIn(campaign_info_code,action,message,redirect_url){$.cookie("pbsol.redirect_url",redirect_url||window.location.href,{expires:360,path:'/',domain:COOKIE_DOMAIN});$.cookie("tmp_campaign_info",campaign_info_code,{expires:1,path:'/',domain:COOKIE_DOMAIN});window.GAaction=action||'';triggerLogin(message);}
function cancelLogin(){$.cookie("tmp_data_watchlist",null,{expires:-1,path:'/',domain:COOKIE_DOMAIN});$.cookie("tmp_data_programs",null,{expires:-1,path:'/',domain:COOKIE_DOMAIN});$.cookie("tmp_campaign_info",null,{expires:-1,path:'/',domain:COOKIE_DOMAIN});}
function logIn(campaign_info_code,provider,url){var innerProvider;if(window.GAaction){switch(provider){case'facebook':innerProvider='Facebook';break;case'openid':innerProvider='PBS';break;case'googleplus':innerProvider='Google';break;}
if(campaign_info_code){$.cookie("tmp_campaign_info",campaign_info_code,{expires:1,path:'/',domain:COOKIE_DOMAIN});}
PBS.GA.trackEvent('Video - Portal','Sign In - '+window.GAaction,innerProvider);}}
function logOut(){var iframe=document.createElement("iframe");iframe.className="hidden";document.body.appendChild(iframe);iframe.src="https://account.pbs.org/oauth2/logout/";$(iframe).load(function(){$.ajax({url:'/logout/',headers:CUSTOM_HEADERS,type:'post',success:function(data){location.reload();}});});}
function getGACategory(){var category='Video - Portal';if(is_wrapped){category='Video - iOS App';}
if(is_kindle_wrapped){category='Video - Kindle Fire App';}
return category;}
function logGAVideo(video_id,video_title,program_title,action,opt_value){PBS.GA.trackEvent(PBS.Profile.getGACategory(),action,program_title+" | "+htmlEntities(video_title)+" | "+video_id,opt_value);}
function logGAProgram(title){PBS.GA.trackEvent(PBS.Profile.getGACategory(),'Favorite Program',title);}
function getProvider(){return PBS.Storage.getStorageItem(localStorage,'pbs_mw_provider');}
var favoriteVideos={add:function(id,title,programTitle){$.ajax({url:'/profile/addFavoriteVideo/'+id+'/',headers:CUSTOM_HEADERS,type:'post',success:function(data){PBS.Profile.logGAVideo(id,title,programTitle,'Watchlist');}});},remove:function(id){$.ajax({url:'/profile/removeFavoriteVideo/'+id+'/',headers:CUSTOM_HEADERS,type:'post',success:function(data){}});}},watchedVideos={add:function(id,timecode){$.ajax({url:'/profile/addWatchedVideo/'+id+'/',headers:CUSTOM_HEADERS,type:'post',data:{timecode:timecode},success:function(data){}});},clear:function(){$.ajax({url:'/profile/clearWatchedVideos/',headers:CUSTOM_HEADERS,type:'post',success:function(data){}});},get:function(id){var video=null;$.ajax({url:'/profile/getWatchedVideo/'+id+'/',headers:CUSTOM_HEADERS,type:'post',async:false,success:function(data){if(!data.errorCode){video=data.video;}}});return video;},remove:function(id){$.ajax({url:'/profile/removeWatchedVideo/'+id+'/',headers:CUSTOM_HEADERS,type:'post',success:function(data){}});}},favoritePrograms={add:function(slug,title){$.ajax({url:'/profile/addFavoriteProgram/'+slug+'/',headers:CUSTOM_HEADERS,type:'post',success:function(){PBS.Profile.logGAProgram(title);}});},remove:function(slug){$.ajax({url:'/profile/removeFavoriteProgram/'+slug+'/',headers:CUSTOM_HEADERS,type:'post',success:function(data){}});}},favoriteStations={add:function(callSign,zipCode){$.ajax({url:'/profile/addFavoriteStation/'+callSign+'/',headers:CUSTOM_HEADERS,type:'post',async:false,data:{zipcode:zipCode},success:function(data){}});}},devices={add:function(deviceType,authCode,callback){$.ajax({url:'/profile/addRegisteredDevice/',headers:CUSTOM_HEADERS,type:'post',async:true,data:{deviceType:deviceType,authCode:authCode},success:function(data){if($.isFunction(callback)){callback(data);}}});}},clientId={get:function(){var id=null;$.ajax({url:'/profile/getClientId/',type:'get',async:false,success:function(data){id=data.client_id;}});return id;}},uua={setData:function(data){PBS.Storage.setStorageItem(localStorage,'uua_data',data);},getData:function(){var data=null;try{data=JSON.parse(PBS.Storage.getStorageItem(localStorage,'uua_data'));}catch(e){}
return data;},upgrade:function(callback){var newData=PBS.Profile.uua.getData();if(newData){ $.ajax({url:'/profile/upgrade/',headers:CUSTOM_HEADERS,type:'post',data:{data:JSON.stringify(newData)},success:function(data){if($.isFunction(callback)){callback();}}}); PBS.Storage.removeStorageItem(localStorage,'uua_data');}}};return{watchedVideos:watchedVideos,favoriteVideos:favoriteVideos,favoritePrograms:favoritePrograms,favoriteStations:favoriteStations,devices:devices,clientId:clientId,uua:uua,getGACategory:getGACategory,logGAVideo:logGAVideo,logGAProgram:logGAProgram,triggerLogin:triggerLogin,cancelLogin:cancelLogin,logIn:logIn,logOut:logOut,signIn:signIn,getProvider:getProvider};}());}(window,jQuery));(function(window){"use strict"; if(!window.PBS){window.PBS={};} 
PBS.GA=(function(){var tracker=[];var page_tracking=[];var event_tracking=[];var profile_tracking=[];window._gaq=window._gaq||[]; function registerPageviewTrackingCode(code){page_tracking.push(code);} 
function registerEventTrackingCode(code){event_tracking.push(code);} 
function registerProfileTrackingCode(code){profile_tracking.push(code);} 
function registerDomainName(domain){window._gaq.push(['_setDomainName',domain]);} 
function trackPageview(){var i;for(i in page_tracking){if(page_tracking.hasOwnProperty(i)){tracker[i]='pt'+i;window._gaq.push([tracker[i]+'._setAccount',page_tracking[i]],[tracker[i]+'._trackPageview']);}}} 
function trackEvent(category,action,opt_label,opt_value,opt_noninteraction,callbackFunction,group){var i,localTracker,currentLocation=window.location.protocol+'//'
+window.location.hostname
+window.location.pathname
+window.location.search;for(i in event_tracking){if(event_tracking.hasOwnProperty(i)){localTracker='et'+(new Date()).getTime();window._gaq.push([localTracker+'._setAccount',event_tracking[i]],[localTracker+'._trackEvent',category,action,opt_label||null,opt_value||null,opt_noninteraction||null],currentLocation);}} 
group=group||'media';PBS.UGA.trackEvent(category,action,opt_label,opt_value,opt_noninteraction,callbackFunction,group);} 
function setCustomVar(index,name,value,opt_scope){var i;for(i in page_tracking){if(page_tracking.hasOwnProperty(i)){tracker[i]='pt'+i;window._gaq.push([tracker[i]+'._setCustomVar',index,name,value,opt_scope]);}}} 
function trackProfileEvent(category,action,opt_label,opt_value,opt_noninteraction){var i,localTracker;for(i in profile_tracking){if(profile_tracking.hasOwnProperty(i)){localTracker='et'+(new Date()).getTime();window._gaq.push([localTracker+'._setAccount',profile_tracking[i]],[localTracker+'._trackEvent',category,action,opt_label||null,opt_value||null,opt_noninteraction||null]);}}}
return{registerPageviewTrackingCode:registerPageviewTrackingCode,registerEventTrackingCode:registerEventTrackingCode,registerProfileTrackingCode:registerProfileTrackingCode,registerDomainName:registerDomainName,trackPageview:trackPageview,trackEvent:trackEvent,trackProfileEvent:trackProfileEvent,setCustomVar:setCustomVar};}());}(window));!function(a){function c(a,b,c){var d=a.children(),e=!1;a.empty();for(var g=0,h=d.length;h>g;g++){var i=d.eq(g);if(a.append(i),c&&a.append(c),f(a,b)){i.remove(),e=!0;break}c&&c.detach()}return e}function d(b,c,g,h,i){var j=b.contents(),k=!1;b.empty();for(var l="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",m=0,n=j.length;n>m&&!k;m++){var o=j[m],p=a(o);"undefined"==typeof o||3==o.nodeType&&0==a.trim(o.data).length||(b.append(p),i&&b[b.is(l)?"after":"append"](i),3==o.nodeType?f(g,h)&&(k=e(p,c,g,h,i)):k=d(p,c,g,h,i),k||i&&i.detach())}return k}function e(a,b,c,d,h){var k=!1,l=a[0];if("undefined"==typeof l)return!1;for(var m=j(l),n=-1!==m.indexOf(" ")?" ":"\u3000",o="letter"==d.wrap?"":n,p=m.split(o),q=-1,r=-1,s=0,t=p.length-1;t>=s&&(0!=s||0!=t);){var u=Math.floor((s+t)/2);if(u==r)break;r=u,i(l,p.slice(0,r+1).join(o)+d.ellipsis),f(c,d)?t=r:(q=r,s=r),t==s&&0==t&&d.fallbackToLetter&&(o="",p=p[0].split(o),q=-1,r=-1,s=0,t=p.length-1)}if(-1==q||1==p.length&&0==p[0].length){var v=a.parent();a.remove();var w=h?h.length:0;if(v.contents().size()>w){var x=v.contents().eq(-1-w);k=e(x,b,c,d,h)}else{var y=v.prev(),l=y.contents().eq(-1)[0];if("undefined"!=typeof l){var m=g(j(l),d);i(l,m),h&&y.append(h),v.remove(),k=!0}}}else m=g(p.slice(0,q+1).join(o),d),k=!0,i(l,m);return k}function f(a,b){return a.innerHeight()>b.maxHeight}function g(b,c){for(;a.inArray(b.slice(-1),c.lastCharacter.remove)>-1;)b=b.slice(0,-1);return a.inArray(b.slice(-1),c.lastCharacter.noEllipsis)<0&&(b+=c.ellipsis),b}function h(a){return{width:a.innerWidth(),height:a.innerHeight()}}function i(a,b){a.innerText?a.innerText=b:a.nodeValue?a.nodeValue=b:a.textContent&&(a.textContent=b)}function j(a){return a.innerText?a.innerText:a.nodeValue?a.nodeValue:a.textContent?a.textContent:""}function k(b,c){return"undefined"==typeof b?!1:b?"string"==typeof b?(b=a(b,c),b.length?b:!1):"object"==typeof b?"undefined"==typeof b.jquery?!1:b:!1:!1}function l(a){for(var b=a.innerHeight(),c=["paddingTop","paddingBottom"],d=0,e=c.length;e>d;d++){var f=parseInt(a.css(c[d]),10);isNaN(f)&&(f=0),b-=f}return b}function m(a,b){return a?(b="string"==typeof b?"dotdotdot: "+b:["dotdotdot:",b],"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(b),!1):!1}if(!a.fn.dotdotdot){a.fn.dotdotdot=function(e){if(0==this.length)return e&&e.debug===!1||m(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){a(this).dotdotdot(e)});var g=this;g.data("dotdotdot")&&g.trigger("destroy.dot"),g.data("dotdotdot-style",g.attr("style")),g.css("word-wrap","break-word"),"nowrap"===g.css("white-space")&&g.css("white-space","normal"),g.bind_events=function(){return g.bind("update.dot",function(b,e){b.preventDefault(),b.stopPropagation(),j.maxHeight="number"==typeof j.height?j.height:l(g),j.maxHeight+=j.tolerance,"undefined"!=typeof e&&(("string"==typeof e||e instanceof HTMLElement)&&(e=a("<div />").append(e).contents()),e instanceof a&&(i=e)),q=g.wrapInner('<div class="dotdotdot" />').children(),q.empty().append(i.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var h=!1,k=!1;return n.afterElement&&(h=n.afterElement.clone(!0),n.afterElement.remove()),f(q,j)&&(k="children"==j.wrap?c(q,j,h):d(q,g,q,j,h)),q.replaceWith(q.contents()),q=null,a.isFunction(j.callback)&&j.callback.call(g[0],k,i),n.isTruncated=k,k}).bind("isTruncated.dot",function(a,b){return a.preventDefault(),a.stopPropagation(),"function"==typeof b&&b.call(g[0],n.isTruncated),n.isTruncated}).bind("originalContent.dot",function(a,b){return a.preventDefault(),a.stopPropagation(),"function"==typeof b&&b.call(g[0],i),i}).bind("destroy.dot",function(a){a.preventDefault(),a.stopPropagation(),g.unwatch().unbind_events().empty().append(i).attr("style",g.data("dotdotdot-style")).data("dotdotdot",!1)}),g},g.unbind_events=function(){return g.unbind(".dot"),g},g.watch=function(){if(g.unwatch(),"window"==j.watch){var b=a(window),c=b.width(),d=b.height();b.bind("resize.dot"+n.dotId,function(){c==b.width()&&d==b.height()&&j.windowResizeFix||(c=b.width(),d=b.height(),p&&clearInterval(p),p=setTimeout(function(){g.trigger("update.dot")},10))})}else o=h(g),p=setInterval(function(){var a=h(g);(o.width!=a.width||o.height!=a.height)&&(g.trigger("update.dot"),o=h(g))},100);return g},g.unwatch=function(){return a(window).unbind("resize.dot"+n.dotId),p&&clearInterval(p),g};var i=g.contents(),j=a.extend(!0,{},a.fn.dotdotdot.defaults,e),n={},o={},p=null,q=null;return j.lastCharacter.remove instanceof Array||(j.lastCharacter.remove=a.fn.dotdotdot.defaultArrays.lastCharacter.remove),j.lastCharacter.noEllipsis instanceof Array||(j.lastCharacter.noEllipsis=a.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),n.afterElement=k(j.after,g),n.isTruncated=!1,n.dotId=b++,g.data("dotdotdot",!0).bind_events().trigger("update.dot"),j.watch&&g.watch(),g},a.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1},a.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","\u3000",",",";",".","!","?"],noEllipsis:[]}};var b=1,n=a.fn.html;a.fn.html=function(a){return"undefined"!=typeof a?this.data("dotdotdot")&&"function"!=typeof a?this.trigger("update",[a]):n.call(this,a):n.call(this)};var o=a.fn.text;a.fn.text=function(b){if("undefined"!=typeof b){if(this.data("dotdotdot")){var c=a("<div />");return c.text(b),b=c.html(),c.remove(),this.trigger("update",[b])}return o.call(this,b)}return o.call(this)}}}(jQuery);(function(window,$){'use strict'; if(!window.PBS){window.PBS={};} 
PBS.Watchlist=(function(){function updateBubble(diff){var $bubbleDesk=$('#watchlistLinkDesk .bubble'),$bubbleSide=$('#watchlistLinkSide .bubble'),count=parseInt($bubbleDesk.text(),10)||0;count=count+parseInt(diff,10);$bubbleDesk.text(count);$bubbleSide.text(count);if(count<1){$bubbleDesk.addClass('hidden');$bubbleSide.addClass('hidden');}else{$bubbleDesk.removeClass('hidden');$bubbleSide.removeClass('hidden');}}
var add,remove;add=function(video_id,video_title,video_program_title,callback){if($.cookie('pbs_si')){PBS.Profile.favoriteVideos.add(video_id,video_title,video_program_title);$('a[data-videoid="'+video_id+'"]').html('<span class="nav-icon minus">&nbsp;</span>');updateBubble(1);if($.isFunction(callback)){callback({errorCode:0,errorMessage:'Great success!'});}}else{$.cookie("tmp_data_watchlist",video_id,{expires:1,path:'/',domain:COOKIE_DOMAIN});PBS.Profile.signIn('VID','Add to Watchlist','watchlist');}};remove=function(video_id,type,callback){switch(type){case'watched':PBS.Profile.watchedVideos.remove(video_id);break;default:PBS.Profile.favoriteVideos.remove(video_id);break;}
if(window.location.pathname.indexOf('watchlist')!==-1){$('a[data-videoid="'+video_id+'"] .js-remove-'+type).closest('.videoItem').hide();}else{$('a[data-videoid="'+video_id+'"]').html('<span class="nav-icon plus"><span class="plus-sign">&#43;</span> ADD</span>');}
if(type==="favorite"){updateBubble(-1);}
if($.isFunction(callback)){callback({errorCode:0,errorMessage:'Great success!'});}};return{add:add,remove:remove};}());}(window,jQuery));(function(window,$){"use strict"; if(!window.PBS){window.PBS={};}
var br=[];function markResponsiveImg(breakpoints){var attr='',i;if(!(breakpoints instanceof Object)||!breakpoints){return'';}
for(i in breakpoints){if(Object.prototype.hasOwnProperty.call(breakpoints,i)){attr+=' data-resp'+i+'="'+breakpoints[i]+'" ';if(br.indexOf(i)<0){br.push(i);}}}
return attr;}
function updateImages(){var windowWidth=$(window).width(),getNewSrc=function(src,newWidth){return src.replace(/\.resize\.[\d\.]+x[\d\.]+\.jpg/g,'.resize.'+newWidth+'x'+(9/16*newWidth)+'.jpg');},alreadyDone=[],i; br.sort(function(a,b){var r=0;if(b>a){r=1;}else if(a>b){r=-1;}
return r;});function doUpdate(){var $this=$(this),src,newSrc;if(alreadyDone.indexOf(this)<0&&br[i]<windowWidth){src=$this.attr('src');newSrc=getNewSrc(src,$this.data('resp'+br[i]));if(src!==newSrc){$this.attr('src',newSrc);}
alreadyDone.push(this);}}
for(i in br){if(Object.prototype.hasOwnProperty.call(br,i)){$('img[data-resp'+br[i]+']').each(doUpdate);}}}
PBS.ResponsiveImages={mark:markResponsiveImg,getResizedSrc:function(src,w){var prefix=ITS_PREFIX,strippedSrc=src.replace('http://','');if(!isNaN(w)){return prefix+strippedSrc+'.fit.'+parseInt(w,10)+'x'+parseInt(9/16*w,10)+'.jpg';}
if($(window).width()>480){return prefix+strippedSrc+'.fit.256x144.jpg';}
return prefix+strippedSrc+'.fit.480x270.jpg';},init:function(){}};}(window,jQuery));if(!window.PBS){window.PBS={};}
PBS.MobileWeb=(function(){'use strict';var searchForm=null,menuStatus=null,menu=null,page=null,menuBtn=null;function validateSearchForm(elem){var searchInput,searchValue;if(!elem){console.error(elem+' is not a valid DOM element!');return null;}
searchInput=elem.find('input');searchValue=searchInput.val();if(searchValue===''){return false;}
return true;}
function openMenu(state){if(state){var windowWidth=$(window).width(),menuHeight=menu.height();if($('#iabContent').lenght){$('#iabContent').hide();}
menu.show();$('body').addClass('menuOpened');$('body').css({'height':menuHeight,'overflow-x':'hidden'});page.css({'width':windowWidth,'position':'fixed','left':'0','margin-left':'260px'});}else{menu.hide();$('body').removeAttr('style');$('body').removeAttr('class');page.removeAttr('style');}}
function initNavigation(){ searchForm=$('.searchForm');menuStatus=false;menu=$('#mobileMenu');page=$('#page');menuBtn=$('#menuButton'); PBS.MobileWeb.videoListsConfig(); menuBtn.on('click',function(){if(!menuStatus){openMenu(true);menuStatus=true;}else{openMenu(false);menuStatus=false;}
return false;}); searchForm.submit(function(){if(!validateSearchForm($(this))){return false;}});}
function initWatchlist(){ $('div.watchlist a').live('click',function(){var $this=$(this),vidId,vidTitle,vidProg,toolTipHtml='',noResultsHtml='',type,$i=$this.find('span.nav-icon');toolTipHtml+='<div class="tooltip">';toolTipHtml+='<div class="message">';toolTipHtml+='This video has been added to your ';toolTipHtml+='watchlist. Access your watchlist ';toolTipHtml+='from the main menu.';toolTipHtml+='</div>';toolTipHtml+='<div class="indicator"></div>';toolTipHtml+='</div>';noResultsHtml+='<li id="noItems">';noResultsHtml+='There are no items to be displayed.</li>';vidId=parseInt($(this).data('videoid'),10);vidTitle=$(this).data('title');vidProg=$(this).data('programtitle');if($i.hasClass('plus')){PBS.Watchlist.add(vidId,vidTitle,vidProg,function(){var $tooltip=$(toolTipHtml),$body=$('body'),offset=$this.offset(),leftOffset=offset.left,tooltipLeft,removeTooltip,timeout;$body.append($tooltip);tooltipLeft=leftOffset-$tooltip.width()+28;$tooltip.css({'top':(offset.top-$tooltip.height()),'left':tooltipLeft});removeTooltip=function(){$tooltip.remove();$body.off('click touchstart');$(window).off('resize',removeTooltip);}; setTimeout(function(){$(window).on('resize',removeTooltip);},100);timeout=setTimeout(function(){timeout=null;$tooltip.fadeOut('fast',function(){removeTooltip();});},10000);$body.on('click touchstart',function(){if(timeout){clearTimeout(timeout);}
removeTooltip();});});}else if($i.hasClass("minus")||$i.hasClass("remove")){type=$i.hasClass('js-remove-watched')?'watched':'favorite';PBS.Watchlist.remove(parseInt($this.data("videoid"),10),type,function(response){if(response.errorCode===0&&$this.parents("#watchlist").length){

 if($this.parents('li').siblings().length===0){$this.parents('li').after(noResultsHtml);}
$this.parents('li').remove();}});}
return false;});}

function showPageLoadingMsg(msg){var loadingMessageHtml='<div id="loadingOverlay">';loadingMessageHtml+='<div class="window">';loadingMessageHtml+='<div class="loading"></div>';loadingMessageHtml+=msg;loadingMessageHtml+='</div></div>';$('body').append(loadingMessageHtml);}
function hidePageLoadingMsg(){$('#loadingOverlay').remove();}
function truncateText(elem,more){var $elem=$(elem);$elem.dotdotdot({watch:'window',after:more?$('<a class="read-more"> More</a>'):null,callback:!more?null:function(){var $moreLink=$elem.find('a.read-more');$moreLink.click(function(){var content=$elem.triggerHandler('originalContent');$elem.trigger('destroy');$elem.append(content);$elem.css('height','auto');$moreLink.remove();return false;});}});}
function videoListsConfig(){var listSelector=$('.videoItem').find('.description');if(listSelector.length>0){truncateText(listSelector);}}
function succesfulLogin(){if(window.GYGprovider){PBS.GA.trackEvent('Video - Portal','Sign In - Success',window.GYGprovider);}
window.location.href=window.location.mvod_successfulLogin_redirect||window.location.pathname;} 
function trackDonate(){var station=PBS.Local.getStation()||'PBS';$('.donate a').on('click',function(){PBS.GA.trackEvent('Video Portal Navigation, Donate',station);});$('#footerDonateStationLogo').on('click',function(){PBS.GA.trackEvent('Video Portal Footer, Donate Station Logo',station);});$('#footerDonateGiveNowText').on('click',function(){PBS.GA.trackEvent('Video Portal Footer, Give Now Text',station);});
 $('#holidaySmallDonate').on('click',function(){PBS.GA.trackEvent('Video Portal Funder - Donate Banner, Donate',station);});$('#holidaySmallSupport').on('click',function(){PBS.GA.trackEvent('Video Portal Funder - Support Banner, Donate',station);}); $('#holidayBigDonate').on('click',function(){PBS.GA.trackEvent('Video Portal Header  - Donate Banner, Donate',station);});$('#holidayBigSupport').on('click',function(){PBS.GA.trackEvent('Video Portal header - Support Banner, Donate',station);}); $('#singleHeadBanner').on('click',function(){PBS.GA.trackEvent('Video Portal Events','Header Banner','PBS Anywhere');});$('#singleFunderBanner').on('click',function(){PBS.GA.trackEvent('Video Portal Events','Funder Banner','PBS Anywhere');});}
function setActiveState(){var menuItem=$('#mobileMenu .mainLinks li');menuItem.on('click',function(){menuItem.removeClass('active');$(this).addClass('active');});}
function hideHDnotification(){var notification=$('#hdNotification');if(notification.length>0){notification.hide();}}
function toggleEndHdMessage(state){var notification=$('#endHDNotification'),windowWidth=$(window).width();if(notification.length>0&&windowWidth>1024){if(state==="show"){notification.show();$('.loginStationImage').html($('#localizedStation').html());$.cookie("tmp_campaign_info","HD-end",{expires:1,path:'/',domain:COOKIE_DOMAIN});$.cookie("pbsol.redirect_url",window.location.href,{expires:360,path:'/',domain:COOKIE_DOMAIN});
 window.GAaction="HD End Screen";}
if(notification.is(":visible")&&state==="hide"){notification.hide();}}}
function setHDnotificationFlag(){var hideOverlay=PBS.Storage.getStorageItem(sessionStorage,'hideOverlay');if(!hideOverlay){PBS.Storage.setStorageItem(sessionStorage,'hideOverlay',true);}}
function hDNotification(){var notification=$('#hdNotification'),hideOverlay=PBS.Storage.getStorageItem(sessionStorage,'hideOverlay');if(notification.length>0){if(!hideOverlay&&!$.cookie('pbs_si')){notification.show();}
notification.on('click','a.close',function(event){setHDnotificationFlag();notification.hide();event.preventDefault();});}}
function init(){setActiveState();initNavigation();initWatchlist();trackDonate();hDNotification();}
$(window).resize(function(){var windowWidth=$(window).width(); if($('body').hasClass('menuOpened')&&windowWidth<=1280){$('#page').width(windowWidth);}});$(document).on('click','.inherit-link',function(){ window.location.href=$(this).find('a').attr('href');});return{ITEMS_PER_PAGE:12,showPageLoadingMsg:showPageLoadingMsg,hidePageLoadingMsg:hidePageLoadingMsg,truncateText:truncateText,videoListsConfig:videoListsConfig,init:init,succesfulLogin:succesfulLogin,setActiveState:setActiveState,hideHDnotification:hideHDnotification,toggleEndHdMessage:toggleEndHdMessage,setHDnotificationFlag:setHDnotificationFlag};}());(function(window,$){if(!window.PBS){window.PBS={};}
PBS.Ads=(function(){function removeEmptyAd(ad){var li=ad.parents('li');if(li.length){li.remove();}else{ad.remove();}}
function showAd(ad){var li=ad.parents('li');if(li.length){li.removeClass('none');}
ad.css('display','block');PBS.MobileWeb.videoListsConfig();}
function removeAd(){$('#footer').css('margin-bottom',0);}
function closeAd(){removeAd();$('#iab').remove();}
function fixAdHeight(height){$('#iab').css({'display':'block'});$('#footer').css('margin-bottom',height);}
function check(){$('.advertisement').each(function(){var ad=$(this),timer,counter=0;timer=setInterval(function(){counter+=1;var img=ad.find('img');if((!img.length&&(counter>50))||(img.length&&img.attr('src').indexOf('grey.gif')>=0)){
 removeEmptyAd(ad);clearInterval(timer);counter=0;}
if(img.length&&img.attr('src').indexOf('grey.gif')<0){ showAd(ad);clearInterval(timer);counter=0;}},100);});}
return{check:check,closeAd:closeAd,removeAd:removeAd,fixAdHeight:fixAdHeight};})();})(window,jQuery);PBS.Ads.check();(function(window,$){"use strict";if(!window.PBS){window.PBS={};}
PBS.Content=(function(){function renderTemplate(template,mapping,list,data){var htmlData='',i,key,itemHtml;if(data&&data.length){for(i in data){if(Object.prototype.hasOwnProperty.call(data,i)){itemHtml=template;for(key in mapping){if(Object.prototype.hasOwnProperty.call(mapping,key)){itemHtml=itemHtml.replace(new RegExp('{'+key+'}','gi'),eval(mapping[key]));}}
htmlData+=itemHtml;}}}else if(!list.children(':not(#loadMore)').length){htmlData+='<li id="noItems">There are no items to be displayed.</li>';}
return htmlData;}
function appendToListContent(template,mapping,list,data){list.append(renderTemplate(template,mapping,list,data));}
function displayListContent(template,mapping,list,data){var children=list.children(':not(#loadMore)');if(!children.length){children.remove();list.prepend(renderTemplate(template,mapping,list,data));}}
function checkEOL(list,data,count){if(data.length<count){list.find('#loadMore').remove();}}
function refreshList(list,count){var loadMoreAnchor=list.find('#loadMore'),listSize,href;if(loadMoreAnchor.length){listSize=parseInt(list.find('li').length,10)-1;href=loadMoreAnchor.find('a').attr('href').replace(/start\/[\d\.]+/g,"start/"+listSize).replace(/end\/[\d\.]+/g,"end/"+(listSize+count));loadMoreAnchor.find('a').attr('href',href);if(list.find('li:last').attr('id')!=='loadMore'){list.find('#loadMore').insertAfter(list.find('li:last'));}}}
function getVideoTag(src){switch(src){case'#previews':return'previews';case'#shorts':return'shorts'; default:return'episodes';}}
function loadMoreItems(url,container,template,mapping,append,callback){var count=PBS.MobileWeb.ITEMS_PER_PAGE;container.append($("<li id='loading' />"));container.find('#loadMore').hide();$.ajax({url:url,headers:CUSTOM_HEADERS,success:function(data){container.find('#loading').remove();container.find('#loadMore').show();checkEOL(container,data,count);if(append){appendToListContent(template,mapping,container,data);}else{displayListContent(template,mapping,container,data);}
refreshList(container,count);PBS.MobileWeb.videoListsConfig();if($.isFunction(callback)){callback();}}});}
function loadMoreItemsJSON(data,container,template,mapping,append,callback){var count=PBS.MobileWeb.ITEMS_PER_PAGE,i;container.append($("<li id='loading' />"));for(i=0;i<data.length;i+=1){appendToListContent(template,mapping,container,data[i]);if(append){appendToListContent(template,mapping,container,data);}else{displayListContent(template,mapping,container,data);}}
refreshList(container,count);PBS.MobileWeb.videoListsConfig();if($.isFunction(callback)){callback();}}
function onImageFallback(image,isSquare){var parent=image.parentNode,newElType='span',newEl; var $image=$(image),$parent=$(parent);if($image.hasClass('programlogo')){return parent.removeChild(image);}
if(image.id==='programLogo'){newElType='h2';}
newEl=document.createElement(newElType);switch(newElType){case'span':if(isSquare){newEl.className='imageFallbackSquare';}else{newEl.className='imageFallbackWide';}
$parent.addClass('imageFallback');break;case'h2':newEl.id='programTitle';newEl.innerHTML=image.alt;parent.removeChild(image);break;}
parent.insertBefore(newEl,parent.firstChild);}
function onLogoFallback(image){image.style.display="none";$(".stationTextOnError").addClass("showText");}
function getExpireDateLabel(expire_date){var one_day=1000*60*60*24,now=new Date(),current_date=new Date(now.getFullYear(),now.getMonth(),now.getDate()),expiring=expire_date.split('/'),expiring_date=new Date(expiring[2],expiring[0]-1,expiring[1]),no_of_days=(expiring_date-current_date)/one_day;if(0<=no_of_days<=9){if(no_of_days===0){return"Today";}
if(no_of_days===1){return"Tomorrow";}
return"in "+no_of_days+" Days";}
return"on "+expire_date;}
var NO_IMAGE=STATIC_URL+'img/no_image_480_270.jpg',PBS_LOGO=STATIC_URL+'img/generic_logo_480_270.jpg',defaultMapping={contentID:'data[i].contentID',slug:'data[i].slug ? data[i].slug: ""',data:'data[i].poster_url ? PBS.ResponsiveImages.mark({0: 480, 256: 256}) : ""',poster:'data[i].poster_url ? PBS.ResponsiveImages.getResizedSrc(data[i].poster_url) : NO_IMAGE',pbs_logo:'PBS_LOGO',expiration_info:'data[i].expiredate && data[i].expiring_soon ? \'<span class="expiring">Expires \' + getExpireDateLabel(data[i].expiredate) + "</span>" : ""',program_title:'data[i].program && data[i].program.title ? "<h4 class=\'program\'><a href=\'/program/" + data[i].program.slug + "/\'>" + data[i].program.title.toUpperCase() + "</a></h4>" : ""',episode_title:'data[i].title ? \'<h3 class="title"><a href="/video/\' + data[i].contentID + \'/">\' + data[i].title + "</a></h3>" : ""',episode_description:'data[i].short_description ? data[i].short_description.replace(/(<([^>]+)>)/ig, "") : "&nbsp;"',episode_duration:'data[i].duration.toHHMMSS()',watchlist_status:'(favorite_video_ids.indexOf(data[i].contentID.toString()) > -1) ? "minus" : "plus"',producer:'data[i].program && data[i].program.common_name ? \'<div class="producer">\' + data[i].program.common_name + "</div>" : ""'},programsMapping={slug:'data[i].slug ? data[i].slug: ""',data:'data[i].stack ? PBS.ResponsiveImages.mark({0: 480, 480: 256}) : ""',poster:'data[i].stack ? PBS.ResponsiveImages.getResizedSrc(data[i].stack) : NO_IMAGE',title:'data[i].title ? data[i].title : ""'};return{getVideoTag:getVideoTag,loadMoreItems:loadMoreItems,onImageFallback:onImageFallback,onLogoFallback:onLogoFallback,templates:{videoList:'<li class="videoItem">\
                                <div class="watchlist">\
                                    <a href="#" data-videoid="{contentID}"><span class="nav-icon {watchlist_status}"></span></a>\
                                </div>\
                                <div class="programTitle">\
                                    {program_title}\
                                    {episode_title}\
                                </div>\
                                <a class="image" href="/video/{contentID}/">\
                                    <img {data} src="{poster}" alt="" data-fallback-src="{pbs_logo}" onerror=PBS.Content.onImageFallback(this) />\
                                    {expiration_info}\
                                </a>\
                                <p class="description">{episode_description}</p>\
                                <p class="duration">{episode_duration}</p>\
                            </li>'},mappings:{defaultMapping:defaultMapping,programsMapping:programsMapping}};}());Number.prototype.toHHMMSS=function(showHours){var sec_num=parseInt(this,10),hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-(hours*3600))/60),seconds=sec_num-(hours*3600)-(minutes*60),time;if(hours<10){hours="0"+hours;}
if(minutes<10){minutes="0"+minutes;}
if(seconds<10){seconds="0"+seconds;}
time=showHours?hours+':'+minutes+':'+seconds:minutes+':'+seconds;return time;};}(window,jQuery));"use strict";Modernizr.load({test:Modernizr.localstorage&&Modernizr.sessionstorage,nope:STATIC_URL+"lib/polyfill/storage.js"});PBS.MobileWeb.init();$(function(){ $(".station a").on("click",function(event){JAWS.Localization.init();event.preventDefault();});$.cookie("tz",jstz.determine().name(),{expires:2*7,path:"/",domain:COOKIE_DOMAIN});});(function($){"use strict";$.fn.modalLogin=function(){var modalWindow=$(this),modalOverlay=$(this).parent(),socialLoginPanel=$(this).find('.socialLoginPanel'),modalCloseBtn=$(this).find('.closeBtn'),windowHeight=$(window).height(),heightOffset=0,scrollX,scrollY; if(is_ios){heightOffset=60;}
modalWindow.addClass('initiated'); function closeWindow(){PBS.Profile.cancelLogin();modalOverlay.addClass('none');var video=$('video')[0];if(is_ios&&video){video.removeAttribute('style');}
$('body, #page, #mobileMenu').removeAttr('style'); $('#adFix, #iab').show();}
function scrollFix(){var windowHeight=$(window).height();$('body, #page, #mobileMenu').css({'height':windowHeight+heightOffset,'overflow':'hidden'});} 
$.fn.modalLogin.show=function(){modalOverlay.removeClass('none');scrollFix();var video=$('video')[0];if(is_ios&&video){video.setAttribute('style','visibility:hidden;');} 
$('#adFix, #iab').hide();}; $.fn.modalLogin.showUpgragedMessage=function(){$(this).find('.sign-in').hide();$(this).find('.upgrade').show();}; modalCloseBtn.on('click',closeWindow);};}(jQuery));(function($){'use strict';$.fn.gaPageEventTracking=function(options){var elems=$(this),settings=$.extend({carouselType:'',moreProgramsOverlay:false,seeAll:false,isVideoList:false},options),pageName,locationName,programName,videoName,videoId,link,category="Video - Portal",slideNr; function sendDataToAnalitycs(link,action,label){var callbackFunction;if(link!==null){callbackFunction=function(){window.location.pathname=link;};}
PBS.GA.trackEvent(category,action,label,null,null,callbackFunction,'carousel');} 
function getPageName(){var documentPathName=document.location.pathname;switch(documentPathName.split('/')[1]){case'':pageName="Home Page";break;case'programs':pageName="Programs Page";break;case'program':pageName="Single Program Page";break;}
return pageName;} 
function trackCarousel(carouselType){var currentItem,gaAction,gaLabel;switch(carouselType){case'hero':elems.on('click','li a',function(event){locationName="Carousel Video";currentItem=$(event.currentTarget);programName=currentItem.closest('ul div').find('h4 a').text();videoName=currentItem.closest('ul div').find('h3 a').text();link=currentItem.attr('href');if($.isNumeric(link.slice(7,link.length-1))){videoId=link.slice(7,link.length-1);}else{videoId=programName;}
slideNr=$.fn.heroCarousel.getCurrent();gaAction=pageName+" - "+locationName+" { "+slideNr+" } ";gaLabel=programName+" | "+videoName+" | "+videoId;sendDataToAnalitycs(link,gaAction,gaLabel);event.preventDefault();});break;case'small':elems.on('click','.item',function(event){switch(elems.attr('id')){case'featured_programs':locationName="Carousel Program";break;case'favorite_programs':locationName="Carousel Favorites";break;case'local_programs':locationName="Carousel Local";break;}
currentItem=$(event.currentTarget);programName=currentItem.find('h4').text();link=currentItem.find('a').attr('href');slideNr=$.fn.smallCarousel.getCurrent();gaAction=pageName+" - "+locationName+" { "+slideNr+" } ";gaLabel=programName;sendDataToAnalitycs(link,gaAction,gaLabel);event.preventDefault();});break;case'programs':elems.on('click','.item',function(event){locationName="Carousel Video";currentItem=$(event.currentTarget);programName=elems.find('.programlogo').attr('alt');videoName=currentItem.find('h3 a').text();link=currentItem.find('a:first-child').attr('href');videoId=link.slice(7,link.length-1);slideNr=$.fn.programCarousel.getCurrent();gaAction=pageName+" - "+locationName+" { "+slideNr+" } ";gaLabel=programName+" | "+videoName+" | "+videoId;sendDataToAnalitycs(link,gaAction,gaLabel);event.preventDefault();});elems.on('click','.programLink, .episodeCount, .shortsCount, .previewCount',function(event){currentItem=$(event.currentTarget);switch(currentItem.attr('class')){case'programLink':locationName="Carousel Program";break;case'episodeCount':locationName="Carousel Episodes";break;case'shortsCount':locationName="Carousel Clips";break;case'previewCount':locationName="Carousel Previews";break;}
programName=elems.find('.programlogo').attr('alt');link=currentItem.context.pathname;slideNr=$.fn.programCarousel.getCurrent();gaAction=pageName+" - "+locationName+" { "+slideNr+" } ";gaLabel=programName;sendDataToAnalitycs(link,gaAction,gaLabel);event.preventDefault();});elems.on('click','.videoItem',function(event){currentItem=$(event.currentTarget);locationName="Featured Programs";programName=currentItem.find('h3 a').text();link=currentItem.find('h3 a').attr('href');});break;case'program':elems.on('click','.heroItem',function(event){locationName="Carousel";currentItem=$(event.currentTarget);programName=document.location.pathname.split('/')[2].capitalize().replace('-',' ');videoName=currentItem.find('h3 a').text();link=currentItem.find('a:first-child').attr('href');videoId=link.slice(7,link.length);slideNr=$.fn.heroCarousel.getCurrent();gaAction=pageName+" - "+locationName+" { "+slideNr+" } ";gaLabel=programName+" | "+videoName+" | "+videoId;sendDataToAnalitycs(link,gaAction,gaLabel);event.preventDefault();});break;}} 
function trackProgramsLists(){var currentItem; elems.on('click','.videoItem h3',function(event){currentItem=$(event.currentTarget);locationName="More Programs";programName=currentItem.find('a').text();link=currentItem.find('a').attr('href');event.preventDefault();}); elems.on('click','.programLink, .episodeCount, .shortsCount, .previewCount',function(event){currentItem=$(event.currentTarget);switch(currentItem.attr('class')){case'programLink':locationName="Popup Program";break;case'episodeCount':locationName="Popup Episodes";break;case'shortsCount':locationName="Popup Clips";break;case'previewCount':locationName="Popup Previews";break;}
programName=currentItem.closest('.overlayInfo').find('h2').text();link=currentItem.context.pathname;event.preventDefault();});} 
function trackSeeAllLinks(){elems.on('click',function(event){link=$(this).context.pathname;event.preventDefault();});} 
if(settings.carouselType!==''){trackCarousel(settings.carouselType);} 
if(settings.moreProgramsOverlay){trackProgramsLists();} 
if(settings.seeAll){trackSeeAllLinks();}
pageName=getPageName();};}(jQuery));if(!window.PBS){window.PBS={};}
PBS.UGA=(function(){'use strict';var trackingObjects=[],memberStations=[],id=$.cookie('pbs_si')?PBS.Profile.clientId.get():PBS.Helper.getLocalId(),localized_station=$.cookie('pbsol.station')||station_portal_short_common;function registerMemberStaions(stations){memberStations=stations.split(',');}
function registerTrackingCodes(codes,specificDomain){trackingObjects=codes;var type,group,trackObject,isFirstTrackObject=true,name='',ugaObjects=[],specificDomainCode={};if(specificDomain){specificDomainCode={'cookieDomain':specificDomain};}
for(type in trackingObjects){if(Object.prototype.hasOwnProperty.call(trackingObjects,type)){for(group in trackingObjects[type]){if(Object.prototype.hasOwnProperty.call(trackingObjects[type],group)){ugaObjects=[];for(trackObject=0;trackObject<trackingObjects[type][group].length;trackObject++){name='';if(isFirstTrackObject){isFirstTrackObject=false;_uga('create',trackingObjects[type][group][trackObject],specificDomainCode);}else{name='to'+PBS.Helper.getRandomNr(10);_uga('create',trackingObjects[type][group][trackObject],{'name':name},specificDomainCode);name+='.';}
ugaObjects.push({'code':trackingObjects[type][group][trackObject],'name':name});}
trackingObjects[type][group]=ugaObjects;}}}}} 
function trackPageView(){var type='pageview',group='default',i,ugaArray,ugaArrayLength;ugaArray=trackingObjects[type][group];ugaArrayLength=ugaArray.length;for(i=0;i<ugaArrayLength;i++){_uga(ugaArray[i].name+'set','&dl',location);_uga(ugaArray[i].name+'send','pageview');}}
function trackEvent(category,action,opt_label,opt_value,opt_noninteraction,callbackFunction,group){var i,station,cdIndexes=[5,6,7],type='event',ugaArray,ugaArrayLength,hitCallbackCount=0,trackCallback,location=window.location.protocol+'//'+
window.location.hostname+
window.location.pathname+
window.location.search;group=group||'default';if(!Object.prototype.hasOwnProperty.call(trackingObjects,type)||!Object.prototype.hasOwnProperty.call(trackingObjects[type],group)){return;}
ugaArray=trackingObjects[type][group];ugaArrayLength=ugaArray.length;trackCallback=function(){hitCallbackCount++;if(hitCallbackCount===ugaArrayLength){callbackFunction.apply(this,arguments);}};for(i=0;i<ugaArrayLength;i++){if($.isFunction(callbackFunction)){_uga(ugaArray[i].name+'set','hitCallback',trackCallback);}
_uga(ugaArray[i].name+'set','dimension1',localized_station);_uga(ugaArray[i].name+'set','&uid',id);_uga(ugaArray[i].name+'set','&dl',location);if(memberStations.length>0){for(station in memberStations){if(cdIndexes[station]){_uga(ugaArray[i].name+'set','dimension'+cdIndexes[station],memberStations[station]);}}}
_uga(ugaArray[i].name+'send','event',category,action,opt_label||null,opt_value||null,opt_noninteraction||null);}}
return{registerTrackingCodes:registerTrackingCodes,trackEvent:trackEvent,trackPageView:trackPageView,registerMemberStaions:registerMemberStaions};}());